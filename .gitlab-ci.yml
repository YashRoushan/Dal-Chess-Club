stages:
  - build
  - deploy

build:
  stage: build
  image: node:latest
  script:
    - cd /builds/courses/csci-x691/dal-chess-club/dal-chess-club-x691  # Change to the project directory
    - npm install  # Install dependencies
    - npm run build  # Build your website
  artifacts:
    paths:
      - build/  # Make build directory available for deployment

deploy:
  stage: deploy
  image: ubuntu:latest
  script:
    - apt-get update -qy && apt-get install -y lftp
    - lftp -c "set sftp:auto-confirm yes; open -u chessclub,eshooRi9oofaVah0 sftp://euro.cs.dal.ca; mirror -R build/ /local/websites/chessclub"
  only:
    - main  # Deploy only when changes are pushed to the main branch
